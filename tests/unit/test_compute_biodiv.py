from sspi_flask_app.api.sspi.compute import format_m49_as_stringa
import json
def test_compute_biodiv():
    json.loads([{'_id': {'$oid': '647a0c3524d162df31d2d48f'}, 'collection-info': {'CollectedBy': 'tjmisko', 'RawDataDestination': 'BIODIV', 'CollectedAt': {'$date': '2023-06-02T11:35:13.966Z'}}, 'observation': {'goal': '14', 'target': '14.5', 'indicator': '14.5.1', 'series': 'ER_MRN_MPA', 'seriesDescription': 'Average proportion of Marine Key Biodiversity Areas (KBAs) covered by protected areas (%)', 'seriesCount': '6049', 'geoAreaCode': '4', 'geoAreaName': 'Afghanistan', 'timeCoverage': None, 'upperBound': None, 'lowerBound': None, 'basePeriod': None, 'source': None, 'geoInfoUrl': None, 'age': None, 'freq': None, 'sex': None, 'location': None, 'units': 'PERCENT', 'level_status': None, 'name_of_international_agreement': None, 'education_level': None, 'type_of_product': None, 'type_of_facilities': None, 'name_of_international_institution': None, 'type_of_occupation': None, 'tariff_regime_status': None, 'mode_of_transportation': None, 'type_of_mobile_technology': None, 'name_of_non_communicable_disease': None, 'type_of_skill': None, 'type_of_speed': None, 'migratory_status': None, 'disability_status': None, 'hazard_type': None, 'ihr_capacity': None, 'reporting_type': None, 'cities': None, 'activity': None, 'policy_domains': None, 'years': '[{"year":"[2001]","value":"N","valueType":"String","footnotes":"Non-relevant","Nature":"C","Source Type":"","UnitMultiplier":"","Units":"PERCENT","Management Level":"","Observation Status":"A","Geo Info Type":""},{"year":"[2002]","value":"N","valueType":"String","footnotes":"Non-relevant","Nature":"C","Source Type":"","UnitMultiplier":"","Units":"PERCENT","Management Level":"","Observation Status":"A","Geo Info Type":""},{"year":"[2007]","value":"N","valueType":"String","footnotes":"Non-relevant","Nature":"C","Source Type":"","UnitMultiplier":"","Units":"PERCENT","Management Level":"","Observation Status":"A","Geo Info Type":""},{"year":"[2013]","value":"N","valueType":"String","footnotes":"Non-relevant","Nature":"C","Source Type":"","UnitMultiplier":"","Units":"PERCENT","Management Level":"","Observation Status":"A","Geo Info Type":""},{"year":"[2019]","value":"N","valueType":"String","footnotes":"Non-relevant","Nature":"C","Source Type":"","UnitMultiplier":"","Units":"PERCENT","Management Level":"","Observation Status":"A","Geo Info Type":""}]'}}, ])
    assert format_m49_as_string(5) == '005'
    assert format_m49_as_string(15) == '015'
    assert format_m49_as_string(150) == '150'